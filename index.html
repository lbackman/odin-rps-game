<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style src="script.js"></style>
    <title>Rock Paper Scissors</title>
</head>
<body>

<h1>Rock paper scissors</h1>
<p>Type "game()" in the console and press enter to play.</p>

<script>
    // Declare function computerPlay()
    function computerPlay() {

        // Declare variable that will hold computer's "choice"
        // Let the value will be a number between 1 and 3 inclusive
        const compChoice = Math.floor(Math.random()*3) + 1;

        // Use if else statement to map 1 to rock, 2 to paper, and 3 to scissors
        // Store the new string value in variable computerSelection
        if (compChoice === 1) {
            return "Rock";
        } else if (compChoice === 2) {
            return "Paper";
        } else {
            return "Scissors";
        }
    }
    // Declare function playerPlay()
    function playerPlay() {
        // Ask the player what they want to pick
        const play = prompt("Rock, paper or scissors?");
        // If player presses cancel, return null
        if (play === null) {
            return null;
        // If the player chooses anything other than whatt is asked for: prompt again
        } else if (capitalize(play) !== "Rock" && capitalize(play) !== "Paper" && capitalize(play) !== "Scissors") {
            console.log("That is not a valid choice, please try again");
            playerPlay();
        } else {
            return capitalize(play);
        }
    }

    // Declare function that plays one round of the game
    function playRound(playerSelection, computerSelection) {

        // Make if else statement the iterates over the different outcomes
        if (playerSelection === computerSelection) {
            return "draw";
        } else if ((playerSelection === "Rock" && computerSelection === "Paper") || 
                   (playerSelection === "Paper" && computerSelection === "Scissors") || 
                   (playerSelection === "Scissors" && computerSelection === "Rock")) {
            return "lose";
        } else if (playerSelection === null) {
            return null;
        } else {
            return "win";
        }
    }
    // Declare function that makes sure the playerSelection is always capitalized
    function capitalize (selection) {
        const str1 = selection.toLowerCase();        // First, make the selection all lower case
        const str2 = str1.charAt(0).toUpperCase();   // Make first letter capital
        const str3 = str1.slice(1);                  // Slice off after first letter
        return `${str2}${str3}`;                    // Join the two parts together
    }

    // Declare function game(), which keeps track of overall points
    function game() {
        // Declare initial scores for both players
        let playerScore = 0;
        let computerScore = 0;
        // Use for loop to play best out of 5
        for (i = 0; i < 5; i++) {
            // Declare variables for selections and result inside the for loop
            const playerSelection = playerPlay();
            const computerSelection = computerPlay();
            const result = playRound(playerSelection, computerSelection);
            // Use if loop to tally the correct score
            /* console.log(result); */
            if (result === "draw") {
                console.log(`You both picked ${playerSelection}. That's a draw.`);
                playerScore += 0;
                computerScore += 0;
            } else if ( result === "lose") {
                console.log(`You lose! ${computerSelection} beats ${playerSelection}.`);
                playerScore += 0;
                computerScore += 1;
            } else if (result === null) {
                // Assign an "impossible" score in order to make it easier to cancel in the else if statement below
                playerScore = -1;
                computerScore = -1;
                break;  // Breaks out of the for loop
            } else {
                console.log(`You win! ${playerSelection} beats ${computerSelection}.`);
                playerScore += 1;
                computerScore += 0;
            }
            console.log(`The current score is ${playerScore} - ${computerScore}.`)

        }
        if (playerScore > computerScore) {
            console.log("Congratulations! You won!")
        } else if (playerScore < computerScore) {
            console.log("You lost. Better luck next time.")
        } else if (playerScore === -1 && computerScore === -1) {
            console.log('You canceled the game. Type "game()" to start a new game.');
        } else {
            console.log("It's a tie!")
        }
    }
</script>

</body>
</html>
