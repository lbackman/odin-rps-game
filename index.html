<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <style src="script.js"></style>
    <title>Rock Paper Scissors</title>
</head>
<body>

<h1>Rock Paper Scissors</h1>
<!-- New html below this line -->
<p class="instructions">Pick rock, paper or scissors. First to win five rounds wins the game.</p>
<div class="container">
    <div class="button-container">
        <div class="rock">
            <button id="Rock" class="rps">Rock</button>
        </div>
        <div class="paper">
            <button id="Paper" class="rps">Paper</button>
        </div>
        <div class="scissors">
            <button id="Scissors" class="rps">Scissors</button>
        </div>
    </div>
    <div class="result-container">
        <p id="round"></p>
        <p id="result" class="disabled">
            The score after round <span id="current">0</span> is 
            <span id="player">0</span> - <span id="computer">0</span>.
        </p>
        <p id="final-result"></p>
    </div>
    <div id="restart">
        <button id="restart-button" class="disabled">Play again</button>
    </div>
</div>

<!-- New html above this line -->

<script>

    let playerScore = 0;
    let computerScore = 0;
    let i = 0;
    let para = document.querySelector('#result');
    let round = document.querySelector('#round');
    let current = document.querySelector('#current');
    let p1s = document.querySelector('#player'); //player score in dom
    let p2s = document.querySelector('#computer');
    let final = document.querySelector('#final-result');
    let restart = document.querySelector('#restart-button');

    const buttons = document.querySelectorAll('button.rps');
    buttons.forEach((button) => {
        button.addEventListener('click', function() {
            
            const choice = button.textContent;
            const computer = computerPlay();
            let result = playRound(choice, computer);
            para.classList.remove('disabled');
            
            if (result === 'draw') {
                round.textContent = `You both picked ${choice}; that's a draw.`
                i++;
                current.textContent = i;

            } else if(result === 'lose') {
                round.textContent = `You lose this round. ${computer} beats ${choice.toLowerCase()}.`
                i++;
                computerScore++;
                current.textContent = i;
                p2s.textContent = computerScore;
                if (computerScore >= 5 && playerScore < 5) {
                    final.textContent = "You lost. Better luck next time!"
                    buttons.forEach( button => button.disabled = true );
                    restart.classList.remove('disabled');
                    restart.addEventListener('click', playAgain);
                }

            } else {
                round.textContent = `You win the round! ${choice} beats ${computer.toLowerCase()}.`
                i++;
                playerScore++;
                current.textContent = i;
                p1s.textContent = playerScore;
                if (playerScore >= 5 && computerScore <5) {
                    final.textContent = "You won! Congratulations!";
                    buttons.forEach( button => button.disabled = true );
                    restart.classList.remove('disabled');
                    restart.addEventListener('click', playAgain);
                }
            }
            
        }); 
    });
    function playAgain() {
        restart.classList.add('disabled');
        para.classList.add('disabled');
        buttons.forEach( button => button.disabled = false );
        playerScore = 0;
        computerScore = 0;
        i = 0;
        p1s.textContent = playerScore;
        p2s.textContent = computerScore;
        round.textContent = '';
        current.textContent = i;
        final.textContent = '';
    }

    function computerPlay() {
        const compChoice = Math.floor(Math.random()*3) + 1;

        if (compChoice === 1) {
            return "Rock";
        } else if (compChoice === 2) {
            return "Paper";
        } else {
            return "Scissors";
        }
    }

    function playRound(arg, comp) {
        if (arg == comp) {
            console.log('draw');
            return 'draw';
        } else if ((arg == "Rock" && comp == "Paper") || 
                (arg == "Paper" && comp == "Scissors") || 
                (arg == "Scissors" && comp == "Rock")) {
            console.log('lose');
            return 'lose';
        } else {
            console.log('win');
            return 'win';
	    }
    }
 
</script>

</body>
</html>
